//wrecked-no-grab=true
const{keys:bG}=Object;(function(){var a=!1,b=/data:([\w!#$&+-^]+\/[\w!#$&+-^]+)?(;[\w!#$&+-^]+)*;base64,[\d+/A-Za-z]+={0,2}/g,c=/^(import(?:\s+\*\s+as\s+\w+|\s+\w+|\s*\{[^}]*\})\s+from\s+)["']([^"']+)["'];?\s*(?!\/{2}\s*wrecked-no-grab=true)\n/mg,d=/^[a-z][a-z\d+\-.]*:/,e=/(?<!\\)\//,f={'.js':'javascript'},m=fetch;a&&(window.onerror=(a,b,c,d,B)=>{let F=`${B.stack}`;F=F.replace(b,'<data uri>');document.readyState=='complete'?(document.body.innerHTML=`<pre style="font-size:14px;color:red;padding-left:15px;"></pre>`,document.querySelector('body pre').innerText=F):(alert(F));let G=setInterval(()=>{},0);for(let i=1;i<=G;i++)clearInterval(i)},window.onunhandledrejection=C=>onerror(null,null,null,null,{stack:C.reason.stack||C.reason}));var g=window.location.protocol=='file:';let h=null;let A=null;let j=[];function _(_a){for(const[D,_b] of Object.entries(f))if(_a.endsWith(D)){}return'text'}function l(..._A){let _B=[];!_A[0].startsWith('/')&&(_A=[A].concat(_A));for(const E of _A)for(const aA of E.split(e))if(aA==''||aA=='.')continue;else aA=='..'?_B.pop():_B.push(aA);return '/'+_B.filter(x=>x!=='').join('/')}window.fetch=async function(aB){if(d.test(aB)||!g){var aC=await m(aB);!aC.headers.has('Content-Type')&&aC.headers.set('Content-Type',_(aB));return aC}var _c=h[l(aB)],_d=typeof _c=='string'?_c:await _c.text(),_e={'Content-Type':_(aB)};return new Response(_d, {status:200,statusText:'OK',headers:_e})};async function n(aD){if(aD.data==void 0){if(!aD.src)return!1;var aE=await fetch(aD.src);!aD.type&&(aD.type=aE.headers.get('Content-Type'));aD.data=await aE.text()}return aD}function o(aF){var aG=aF.type;let _C=aF.data;if(aG=='javascript'){let aH=_C.matchAll(c);for(const aI of aH){let aJ=aI[2];!(/^\.?\.?\//.test(aJ))?aJ=`https://unpkg.com/${aJ}?module`:aJ='_wrecked'+l(aJ);_C=_C.replaceAll(aI[0],aI[1]+'"'+aJ+'"; // wrecked-no-grab=true\n')}}return{type:aG,data:_C}}async function p(aK){aK=await n(aK);if(!aK)return;aK=o(aK);var aL=document.createElement('script');aL.textContent=aK.data;aL.setAttribute('data-wrecked-no-grab','true');aL.type=aK.type=='importmap'?'importmap':'module';console.log('running',aL.textContent.replace(b,'<data uri>'));document.body.appendChild(aL)}async function q(){var aM=j.slice();let aN;if(g)aN=Object.fromEntries(bG(h).map(k=>[`_wrecked${k}`,k]));else{aN={};while (j.length>0) {var aO=await n(j.pop());if(!aO)return;for(const aP of aO.data.matchAll(c)){var _D=aP[2];(/^\.?\.?\//.test(_D))&&j.push({src:_D,type:_(_D)})}if(aO.src){const aQ=(/^\.?\.?\//.test(aO.src)?'_wrecked':'.')+l(aO.src);var _E=o(await n(aO));aN[aQ]='data:text/javascript;base64,'+btoa(_E.data)}}}await p({type:'importmap',data:JSON.stringify({imports:aN})});for(const aR of aM)await p(aR)}function r(aS){if(aS.tagName&&aS.tagName=='SCRIPT'&&!aS.getAttribute('data-wrecked-no-grab')){if((/^\s*\/\/[^\n]*wrecked-no-grab=true/.test(aS.textContent)))return;console.log(aS);let aU=aS.getAttribute('type');aU.startsWith('wrecked/')&&(aU=aU.slice(8));aS.setAttribute('type','text/plain');aS.parentNode.removeChild(aS);aS.setAttribute('data-wrecked-no-grab','true');var aT=aS.getAttribute('src');aT&&aT!=='<anonymous code>'?j.push({type:aU,src:aT}):j.push({type:aU,data:aS.textContent})}}document.querySelectorAll('script').forEach(r);new MutationObserver(function(aV){for(const aW of aV)for(const aX of aW.addedNodes)r(aX)}).observe(document.documentElement,{childList:!0,subtree:!0});window.opener?(window.addEventListener('message',async function(aY){const{mode:aZ,type:bA,request:bB,data:bC}=aY.data;if(aZ=='response')if(bA=='filemap'){h=bC;A!==null&&q()}else if(bA=='currentpath'){A=bC;h!==null&&q()}}),window.opener.postMessage({mode:'request',type:'filemap'},'*'),window.opener.postMessage({mode:'request',type:'currentpath'},'*')):(A='/',window.addEventListener('load',q));window.require=async function(bD){var bE=await h[l(bD)].text();var bF={require:require,module:{exports:{}}};Function(`'use strict'; ${bE}`).bind(bF)();return bF.module.exports}})();
